임베딩은 텍스트 트랜스포머(text transformer)에서 처리된 후 잡음 예측기에 공급됩니다. 트랜스포머(transformer)는 조건부여(conditioning)를 위한 범용 어댑터와 같습니다.

트랜스포머는 데이터를 추가로 처리할 뿐 만 아니라, 다양한 조건부여 방식을 수용할 수 있는 메카니즘도 제공합니다. 결국, 일정하게 학습한 데이터를 사용해도 사용자가 조건부여를 달리하면 다른 이미지가 만들어지게 됩니다.

교차 인지(cross-attention)
U-Net 전체에서 노이즈 예측기는 텍스트 트랜스포머의 출력을 여러 번 사용합니다. U-Net은 교차 인지(crosss-attention) 메커니즘을 통해 이를 사용합니다. 여기가 바로 프롬프트가 이미지와 만나는 지점입니다.

"파란 눈을 가진 남자"라는 프롬프트를 예로 들어 보겠습니다. 스테이블 디퓨전은 "파란색"과 "눈"이라는 두 단어를 함께 짝을 지어(프롬프트 내의 교차 인지) 파란 눈을 가진 남자를 생성합니다. (하지만 파란 셔츠를 입은 남자는 생성하지 않습니다.) 그런 다음 이 정보를 사용하여 역방향 확산과정에서  파란 눈이 포함된 이미지로 유도됩니다. (프롬프트와 이미지 간 교차 인지)

. LoRA 모델은 교차 인지(cross-attention) 모듈의 가중치를 수정하여 특정한 스타일을 변경합니다. 교차 인지 모듈을 수정하는 것만으로도 Stable Diffusion 모델을 미세 조정할 수 있다는 사실로부터, 이 모듈이 얼마나 중요한지 알 수 있습니다.
